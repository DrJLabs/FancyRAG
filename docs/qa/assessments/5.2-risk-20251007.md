# Risk Assessment: Story 5.2 (Centralise Typed Settings)

Date: 2025-10-07
Assessor: Quinn (Test Architect)

## Risk Summary

| ID       | Type       | Description                                                                                                                | Likelihood | Impact | Score | Status    | Mitigation |
|----------|------------|----------------------------------------------------------------------------------------------------------------------------|------------|--------|-------|-----------|------------|
| TECH-152 | Technical  | Typed settings refactor misses legacy `ensure_env` call-sites, leaving scripts to bypass validation or crash at runtime.   | Medium (2) | High (3) | 6   | Mitigated | Trace every `ensure_env` reference via `rg`, add coverage that `FancyRAGSettings.load()` is injected everywhere, and run minimal-path smoke to prove CLI entry points initialize settings once. |
| SEC-204  | Security   | Migration surfaces secrets through repr/logs if Pydantic models or error messages echo raw credentials during validation.  | Low (1)    | High (3) | 3   | Mitigated | Enforce sanitizer usage (`mask_base_url`, redacted `ValueError` strings) and create unit tests for failure paths confirming secrets remain masked. |
| DATA-119 | Data       | Misconfigured `.env` migration checklist causes operators to drop preset/telemetry toggles, resulting in inconsistent ingest artefacts. | Low (1) | Medium (2) | 2 | Mitigated      | Documentation lint rule `typed-settings-migration-checklist` enforces the mapping table and command sequence, reducing drift risk. |
| OPS-087  | Operational| Documentation drift leaves `docs/brownfield-architecture.md` and `.env.example` unsynchronized with new settings schema.    | Medium (2) | Medium (2) | 4 | Mitigated | Update docs in same PR, add doc-lint assertions bridging settings fields, and capture reviewer checklist item for config references. |

Overall residual score: 40 (Low risk) with typed settings coverage and documentation lint in place.

## Open Risks & Follow-ups

- None â€” residual risks monitored through existing lint and unit test coverage.

## Mitigation Plan

1. Maintain typed settings unit suite and CLI regression tests in CI (TECH-152).
2. Continue redaction coverage for secrets in failure paths (SEC-204).
3. Keep migration checklist lint rule updated as new settings land (DATA-119).
