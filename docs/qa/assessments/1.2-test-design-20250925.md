# Test Design: Story 1.2

Date: 2025-09-25
Designer: Quinn (Test Architect)

## Test Strategy Overview
- Total test scenarios: 6
- Unit tests: 4 (66%)
- Integration tests: 2 (34%)
- E2E tests: 0 (0%)
- Priority distribution: P0: 4, P1: 2, P2: 0, P3: 0

Strategy focuses on deterministic content validation of `.env.example`, documentation synchronization, and CI enforcement. Risk ties: TECH-201, SEC-201, OPS-201, TECH-202 from the 2025-09-25 risk profile.

## Test Scenarios by Acceptance Criteria

### AC1: `.env.example` enumerates placeholders for OpenAI, Neo4j, Qdrant with guardrails.
| ID              | Level       | Priority | Test Description                                                                    | Justification                                  | Mitigates |
|-----------------|-------------|----------|--------------------------------------------------------------------------------------|------------------------------------------------|-----------|
| 1.2-UNI-001     | Unit        | P0       | Parse `.env.example` and assert all required keys are present exactly once.         | Prevents template drift affecting runtime.      | TECH-201 |
| 1.2-UNI-002     | Unit        | P0       | Verify each placeholder uses safe token (`YOUR_...`) and includes caution comments. | Ensures no realistic secrets or unsafe examples.| SEC-201 |

### AC2: Documentation instructs copy workflow and reinforces secret handling.
| ID              | Level       | Priority | Test Description                                                                    | Justification                                  | Mitigates |
|-----------------|-------------|----------|--------------------------------------------------------------------------------------|------------------------------------------------|-----------|
| 1.2-INT-003     | Integration | P1       | Run doc check ensuring `docs/architecture/overview.md` references `.env.example` copy steps and warns against committing secrets. | Keeps docs aligned with template guardrails. | OPS-201 |

### AC3: Guidance captures default OpenAI models and endpoints.
| ID              | Level       | Priority | Test Description                                                                    | Justification                                  | Mitigates |
|-----------------|-------------|----------|--------------------------------------------------------------------------------------|------------------------------------------------|-----------|
| 1.2-UNI-004     | Unit        | P0       | Assert `.env.example` includes `OPENAI_MODEL=gpt-4o-mini` (commented default) and mentions optional `gpt-4.1-mini`. | Locks model defaults to PRD expectations. | TECH-201 |
| 1.2-UNI-005     | Unit        | P1       | Verify template comments cite Neo4j Bolt URI and Qdrant URL schema.                 | Confirms operators receive endpoint guidance.   | OPS-201 |

### AC4: Automated validation fails when required keys are missing.
| ID              | Level       | Priority | Test Description                                                                    | Justification                                  | Mitigates |
|-----------------|-------------|----------|--------------------------------------------------------------------------------------|------------------------------------------------|-----------|
| 1.2-INT-006     | Integration | P0       | Execute CI guard (pytest/ruff rule) and assert removal of a key triggers failure exit code. | Proves automation protects template integrity. | TECH-202, TECH-201 |

## Risk Coverage
- TECH-201: 1.2-UNI-001, 1.2-UNI-004, 1.2-INT-006
- SEC-201: 1.2-UNI-002
- OPS-201: 1.2-INT-003, 1.2-UNI-005
- TECH-202: 1.2-INT-006

## Recommended Execution Order
1. 1.2-UNI-001
2. 1.2-UNI-004
3. 1.2-UNI-002
4. 1.2-UNI-005
5. 1.2-INT-003
6. 1.2-INT-006

## Gate Snippet
```yaml
test_design:
  scenarios_total: 6
  by_level:
    unit: 4
    integration: 2
    e2e: 0
  by_priority:
    p0: 4
    p1: 2
    p2: 0
    p3: 0
  coverage_gaps: []
```

## Trace Hook
Test design matrix: docs/qa/assessments/1.2-test-design-20250925.md
P0 tests identified: 4

## ðŸ”¬ Research & Validation Log
- Mode: solo (2025-09-25)
- Findings: Test matrix covers key env template risks with automated unit/integration checks, aligns with architecture testing expectations, and includes CI enforcement scenario.
- Sources: docs/architecture/coding-standards.md#testing-expectations, docs/qa/assessments/1.2-risk-20250925.md, docs/stories/1.2.environment-configuration-template.md#testing
- Residual Risks: Need to implement secret scanner coverage and doc-link verification to prevent OPS-201 drift.
- Next Actions: Dev agent to implement tests 1.2-UNI-001/002/004/005 and 1.2-INT-003/006; add CI guard referencing risk mitigation.

