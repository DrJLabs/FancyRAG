# Requirements Traceability Matrix

## Story: 2.5 – Minimal Path Script Automation

### Coverage Summary
- Total Requirements (Acceptance Criteria): 4
- Fully Covered: 3 (75%)
- Partially Covered: 1 (25%)
- Not Covered: 0 (0%)

### Requirement Mappings

#### AC1: Replace `scripts/create_vector_index.py` stub with production-ready implementation (idempotent, structured logs, CLI overrides).
- Coverage: FULL
- Verification artefacts:
  - `tests/unit/scripts/test_create_vector_index.py::test_creates_index_when_missing` and `::test_skips_when_existing_matches` validate creation/idempotency, logging, CLI defaults.
  - `tests/unit/scripts/test_create_vector_index.py::test_mismatch_raises` enforces actionable diagnostics when existing index mismatches expected config.
  - Manual smoke guidance: running `PYTHONPATH=src python scripts/create_vector_index.py --index-name chunks_vec --label Chunk --embedding-property embedding --dimensions 1536 --similarity cosine` produces sanitized JSON logs under `artifacts/local_stack/`.

#### AC2: Replace `scripts/kg_build.py` stub with full `SimpleKGPipeline` orchestration using `SharedOpenAIClient`, retries, and telemetry.
- Coverage: FULL
- Verification artefacts:
  - `tests/unit/scripts/test_kg_build.py::test_run_pipeline_success` confirms Shared client wiring, chunking controls, structured log export, and Neo4j count snapshotting.
  - `tests/unit/scripts/test_kg_build.py::test_run_handles_openai_failure` verifies retry ceiling + surfaced error message when OpenAI calls exhaust attempts.
  - Script logs (`artifacts/local_stack/kg_build.json`) capture sanitised telemetry for smoke automation.

#### AC3: Update runbooks, sample content, and `.env` guidance for minimal path ingestion.
- Coverage: FULL
- Verification artefacts:
  - `docs/architecture/overview.md` Minimal Path Workflow updated with new CLI flags, preflight checks, and log expectations (2025-09-30).
  - `docs/samples/pilot.txt` expanded to demonstrate multi-line pilot content and operator guidance on replacements.
  - Story Dev Notes + QA section reference the latest documentation assets.

#### AC4: Upgrade automation (unit + integration smoke) to exercise the real ingestion flow with retry assertions and reusable fixtures.
- Coverage: PARTIAL
- Verification artefacts:
  - New unit suites (`tests/unit/scripts/test_create_vector_index.py`, `tests/unit/scripts/test_kg_build.py`) validate retries, logging, and Neo4j/OpenAI integrations without external services.
  - `tests/integration/local_stack/test_minimal_path_smoke.py` already orchestrates the full script chain; however, re-running it now requires Docker + valid OpenAI credentials to exercise real ingestion. Compose smoke update is ready but not yet executed in CI—follow-up scheduled to enable once managed secrets provisioned.

### Notes
- Integration smoke should be re-enabled in CI after validating Docker runner resources and provisioning non-production OpenAI credentials to close AC4 gap.
- Log fixtures produced during unit tests can seed upcoming Qdrant export validations.

---
Trace matrix: docs/qa/assessments/2.5-trace-20250930.md
