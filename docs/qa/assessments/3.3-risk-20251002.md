# Risk Profile – Story 3.3 (native-qdrant-retriever)

Date: 2025-10-02
Analyst: Quinn (QA)

## Summary
- Overall residual risk score: 68/100 (moderate).
- Critical risks: None.
- High risks: 1 (join-key mismatch).
- Medium risks: 2 (config drift, telemetry regression).
- Low risks: 1 (doc lag).

## Risk Matrix

| Risk ID | Category | Description | Probability | Impact | Score | Priority |
| --- | --- | --- | --- | --- | --- | --- |
| TECH-101 | Technical | Misconfigured `id_property_neo4j` / `id_property_external` on `QdrantNeo4jRetriever` breaks chunk → context joins, returning empty context or wrong documents. | Medium (2) | High (3) | 6 | High |
| INTEG-102 | Integration | Retriever defaults (e.g., result shape, metadata fields) deviate from bespoke implementation, causing existing consumers/tests to fail or require schema adjustments. | Medium (2) | Medium (2) | 4 | Medium |
| OBS-103 | Observability | Structured log/artifact format drifts (missing `status`, `matches`, or redaction), breaking ingestion QA telemetry and dashboards dependent on prior schema. | Low (1) | Medium (2) | 2 | Medium |
| DOC-104 | Documentation | Architecture overview not updated promptly, leaving operators unaware of new configuration knobs or troubleshooting steps. | Low (1) | Low (1) | 1 | Low |

## Mitigation Strategies
- TECH-101: Add unit tests asserting retriever instantiated with expected join keys (`chunk_id` ↔ payload) and integration smoke verifying Neo4j context is returned for each Qdrant match.
- INTEG-102: Snapshot current CLI output/artifact and compare post-refactor; ensure tests cover no-match, success, and error scenarios using retriever mocks.
- OBS-103: Retain existing logging helper and sanitize pipeline; add regression test comparing serialized payload to fixture to catch format drift.
- DOC-104: Pair code change with documentation update in same PR; add change log entry linking to Story 3.3.

## Risk-Based Testing Focus
1. Verify retriever wiring returns context-rich matches for both payload-provided and fallback IDs (TECH-101).
2. Regression tests covering CLI stdout/artifact structure to detect schema drift (INTEG-102, OBS-103).
3. Smoke run against local stack ensuring telemetry consumers ingest unchanged artifact (INTEG-102).

## Monitoring Recommendations
- Track retrieval success vs. empty-match rate after deployment to detect join failures.
- Monitor log parsing pipelines for schema errors; alert on missing `operation=ask_qdrant` or `status` fields.
- Flag doc build pipeline if architecture overview lacks Story 3.3 references post-merge.

Risk profile: docs/qa/assessments/3.3-risk-20251002.md
