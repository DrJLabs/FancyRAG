# Test Design: Story 1.1

Date: 2025-09-25
Designer: Quinn (Test Architect)

## Test Strategy Overview
- Total test scenarios: 7
- Unit tests: 0 (0%)
- Integration tests: 7 (100%)
- E2E tests: 0 (0%)
- Priority distribution: P0: 5, P1: 2, P2: 0, P3: 0

Strategy leans on integration coverage because the bootstrap script executes shell logic and subprocesses. Tests run the script end-to-end in temporary directories, exercising interpreter checks, virtualenv creation, lockfile generation, import validation, and operator messaging. Risk ties: TECH-001, TECH-002, OPS-001, SEC-001 from the 2025-09-25 risk profile.

## Test Scenarios by Acceptance Criteria

### AC1: Executing `scripts/bootstrap.sh` verifies Python 3.12, creates `.venv`, fails with guidance when incompatible.
| ID              | Level       | Priority | Test Description                                                                    | Justification                                  | Mitigates |
|-----------------|-------------|----------|--------------------------------------------------------------------------------------|------------------------------------------------|-----------|
| 1.1-INT-001     | Integration | P0       | Run script under Python 3.12 (default interpreter) and ensure `.venv` is created.    | Validates success path for interpreter + venv.  | TECH-001, OPS-001 |
| 1.1-INT-002     | Integration | P0       | Execute script with Python 3.11 shim; expect non-zero exit and actionable stderr.    | Confirms enforcement of 3.12 requirement.       | TECH-001 |
| 1.1-INT-003     | Integration | P1       | Run with `--venv-path` override to confirm custom locations are supported.           | Verifies optional argument behaviour.          | OPS-001 |
| 1.1-INT-004     | Integration | P1       | Execute script twice to confirm idempotent reruns reuse `.venv` and keep lockfile.   | Ensures rerun safety and guidance.             | OPS-001 |

### AC2: Install dependencies with extras and pin versions into `requirements.lock`.
| ID              | Level       | Priority | Test Description                                                                    | Justification                                  | Mitigates |
|-----------------|-------------|----------|--------------------------------------------------------------------------------------|------------------------------------------------|-----------|
| 1.1-INT-005     | Integration | P0       | Success path asserts stubbed `requirements.lock` contains pinned packages.          | Confirms deterministic lock generation.         | TECH-002 |

### AC3: Post-install import validation exits non-zero on failure with actionable messaging.
| ID              | Level       | Priority | Test Description                                                                    | Justification                                  | Mitigates |
|-----------------|-------------|----------|--------------------------------------------------------------------------------------|------------------------------------------------|-----------|
| 1.1-INT-006     | Integration | P0       | Set test mode `BOOTSTRAP_TEST_IMPORT=success`; ensure script logs validation step.  | Exercises validation hook for happy path.       | TECH-001 |
| 1.1-INT-007     | Integration | P0       | Set test mode `BOOTSTRAP_TEST_IMPORT=fail`; expect non-zero exit and guidance.       | Confirms failure messaging and exit handling.   | TECH-001, OPS-001 |

### AC4: Script output provides follow-up steps without exposing secrets or tokens.
| ID              | Level       | Priority | Test Description                                                                    | Justification                                  | Mitigates |
|-----------------|-------------|----------|--------------------------------------------------------------------------------------|------------------------------------------------|-----------|
| 1.1-INT-008     | Integration | P0       | Run with `OPENAI_API_KEY` set and assert stdout/stderr omit secret substring.       | Ensures operator guidance stays secret-safe.    | SEC-001 |

## Risk Coverage
- TECH-001: 1.1-INT-001, 1.1-INT-002, 1.1-INT-006, 1.1-INT-007
- TECH-002: 1.1-INT-005
- OPS-001: 1.1-INT-001, 1.1-INT-003, 1.1-INT-004, 1.1-INT-007
- SEC-001: 1.1-INT-008

## Recommended Execution Order
1. 1.1-INT-002 (fail fast on interpreter mismatch)
2. 1.1-INT-001
3. 1.1-INT-003
4. 1.1-INT-004
5. 1.1-INT-005
6. 1.1-INT-006
7. 1.1-INT-007
8. 1.1-INT-008

## Gate Snippet
```yaml
test_design:
  scenarios_total: 7
  by_level:
    unit: 0
    integration: 7
    e2e: 0
  by_priority:
    p0: 5
    p1: 2
    p2: 0
    p3: 0
  coverage_gaps: []
```

## Trace Hook
Test design matrix: docs/qa/assessments/1.1-test-design-20250925.md
P0 tests identified: 5
