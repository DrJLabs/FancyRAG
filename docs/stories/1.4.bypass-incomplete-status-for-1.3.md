# Story 1.4: Bypass Incomplete Status for 1.3

## Status
Done

## Story
**As a** Scrum Master maintaining the BMAD workflow,
**I want** the story drafting tooling to support an explicit override when the prior story remains incomplete,
**so that** we can schedule downstream work while acknowledging and capturing the associated risk.

## Acceptance Criteria
1. `create-next-story` flow surfaces an explicit override path (flag or prompt) that records the user, timestamp, and prior story status before generating the new draft, preventing silent bypasses. [Source: .bmad-core/tasks/create-next-story.md#identify-next-story-for-preparation] [Source: AGENTS.md#Guardrails]
2. When the override is used, the generated story file captures a risk acknowledgement note describing why the bypass happened and references the preceding story for follow-up, ensuring traceability. [Source: .bmad-core/tasks/create-next-story.md#story-draft-completion-and-review] [Source: docs/architecture/coding-standards.md#logging-guidance]
3. Documentation under `docs/bmad` explains how to invoke the override, outlines approval expectations, and links to mitigation steps so teams follow a consistent process. [Source: docs/bmad/focused-epics/environment-workspace/epic.md#story-manager-handoff] [Source: AGENTS.md#Turn Lifecycle]
4. Automated tests cover default blocking behaviour, approved override, and rejection when the override flag is absent, running under Python 3.12 with existing lint/test pipelines. [Source: .bmad-core/tasks/create-next-story.md#sequential-task-execution] [Source: docs/architecture/coding-standards.md#testing-expectations] [Source: docs/architecture/tech-stack.md#technology-stack]

## Tasks / Subtasks
- [x] Update `.bmad-core/tasks/create-next-story` automation to require an explicit `--override-incomplete` confirmation before drafting the next story when the prior status is not `Done`, logging actor and prior status. (AC: 1) [Source: .bmad-core/tasks/create-next-story.md#identify-next-story-for-preparation] [Source: docs/architecture/coding-standards.md#logging-guidance]
  - [x] Persist override context into the generated story metadata with a risk acknowledgement referencing the skipped story number for follow-up. (AC: 2) [Source: .bmad-core/tasks/create-next-story.md#story-draft-completion-and-review]
- [x] Extend `docs/bmad/focused-epics/environment-workspace/epic.md` (or dedicated override guide) with approval workflow, risk checklist, and rollback instructions for using the bypass. (AC: 3) [Source: docs/bmad/focused-epics/environment-workspace/epic.md#story-manager-handoff]
- [x] Add automated tests (unit + integration) covering blocking, override confirmation, and logging outputs under `tests/` to align with BMAD expectations. (AC: 4) [Source: docs/architecture/coding-standards.md#testing-expectations] [Source: docs/architecture/tech-stack.md#technology-stack]
- [x] Update Scrum Master quick-reference (e.g., AGENTS.md or dedicated SOP) to link to the override flag and emphasise risk capture for QA gating. (AC: 3) [Source: AGENTS.md#Guardrails] [Source: AGENTS.md#Turn Lifecycle]

## Dev Notes

<!-- override-note -->
Warning: override of incomplete story status executed.
- Timestamp (UTC): 2025-09-25T18:16:22.983075+00:00
- Actor: ScrumMaster
- Prior Story: 1.3
- Prior Status: Done
- Reason: PO authorised schedule alignment

### Previous Story Insights
- Story 1.3 remains incomplete, and current tooling blocks drafting Story 1.4 until its status is `Done`; override must capture why the skip is accepted. [Source: .bmad-core/tasks/create-next-story.md#identify-next-story-for-preparation]

### Workflow Guardrails
- Overrides must still honour BMAD guardrails that require explicit operator acknowledgement and traceability for risk decisions. [Source: AGENTS.md#Guardrails] [Source: AGENTS.md#Turn Lifecycle]

### Logging Guidance
- Log entries documenting overrides should follow structured logging guidance (operation name, actor, status, timestamp). [Source: docs/architecture/coding-standards.md#logging-guidance]

### Testing Requirements
- Add pytest-based coverage mirroring existing patterns in `tests/` and ensure CI gates remain green. [Source: docs/architecture/coding-standards.md#testing-expectations]

### Project Structure
- Story automation files reside under `.bmad-core/` while documentation updates belong under `docs/bmad/`; keep output paths compliant with the source tree blueprint. [Source: docs/architecture/source-tree.md#source-tree-blueprint]

### Technical Constraints
- Scripts continue to run on Python 3.12 with existing dependency set; avoid introducing external CLIs outside BMAD bundle. [Source: docs/architecture/tech-stack.md#technology-stack]

### Documentation Alignment
- Override workflow documentation should plug into the Environment & Workspace epic to preserve onboarding context. [Source: docs/bmad/focused-epics/environment-workspace/epic.md#story-manager-handoff]

### Secrets Handling
- Override logging must not expose secrets or credentials when capturing context. [Source: docs/architecture/coding-standards.md#critical-rules]

### Data Models
- No specific guidance found in architecture docs.

### API Specifications
- No specific guidance found in architecture docs.

### Component Specifications
- No specific guidance found in architecture docs.

### File Locations
- Expect modifications within `.bmad-core/tasks/`, `.bmad-core/scripts/` (if present), and supporting documentation under `docs/bmad/`. [Source: docs/architecture/source-tree.md#source-tree-blueprint]

## Testing
- Unit test: simulate prior story status `Ready for Review` and assert override prompt declines by default and accepts when flag/prompt approved (covers AC 1,4).
- Integration test: run story drafting command with `--override-incomplete` to confirm risk note injected into output file and structured log entry emitted (covers AC 1,2,4).
- Documentation lint: ensure updated override guidance passes markdown link check or equivalent doc validation (covers AC 3).

## Change Log
| Date       | Version | Description                               | Author |
|------------|---------|-------------------------------------------|--------|
| 2025-09-25 | 0.1     | Initial draft of Story 1.4 created        | Bob    |
| 2025-09-25 | 1.0     | Implementation complete; QA artifacts attached | James  |

## Dev Agent Record
### Agent Model Used
GPT-5 Codex (CLI)

### Debug Log References
* `pytest tests/unit -q`
* `pytest tests/integration/cli -q`
* `pytest tests/integration/scripts/test_bootstrap.py::test_bootstrap_success_generates_lockfile`
* `pytest tests/integration/scripts/test_bootstrap.py::test_bootstrap_rejects_incompatible_python`
* `pytest tests/integration/scripts/test_bootstrap.py::test_bootstrap_supports_custom_venv_path`
* `pytest tests/integration/scripts/test_bootstrap.py::test_bootstrap_is_idempotent`
* `pytest tests/integration/scripts/test_bootstrap.py::test_bootstrap_import_validation_success`
* `pytest tests/integration/scripts/test_bootstrap.py::test_bootstrap_import_validation_failure`
* `pytest tests/integration/scripts/test_bootstrap.py::test_bootstrap_output_masks_secret`

### Completion Notes List
* Added CLI guard `cli.stories` to enforce override acknowledgements and generate risk notes when bypassing incomplete stories.
* Documented override workflow in epic guide and Scrum Master quick reference; created persistent log `docs/bmad/story-overrides.md`.
* Implemented unit/integration coverage for blocking, override logging, and lockfile degradation scenarios.
* Confirmed override note injected into Story 1.4 and recorded new log entry via `python3 -m cli.stories`.

### File List
* .bmad-core/tasks/create-next-story.md
* AGENTS.md
* docs/bmad/focused-epics/environment-workspace/epic.md
* docs/bmad/story-overrides.md
* docs/stories/1.4.bypass-incomplete-status-for-1.3.md
* src/cli/stories.py
* tests/conftest.py
* tests/integration/cli/test_story_override_cli.py
* tests/unit/cli/test_stories.py

## QA Results
### Risk Profile
- PASS (Low risk) â€“ see docs/qa/assessments/1.4-risk-20250925.md (all risks â‰¤ Low, score 94/100). Guard retained in CI smoke; monitor override log hygiene.

### Test Design
- PASS â€“ coverage documented in docs/qa/assessments/1.4-test-design-20250925.md (6 scenarios; unit & integration guard tests in place; doc lint noted for follow-up).

### Traceability
- PASS â€“ matrix in docs/qa/assessments/1.4-trace-20250925.md links ACs to implementation + tests.

### NFR Assessment
- PASS â€“ docs/qa/assessments/1.4-nfr-20250925.md (logging hygiene, maintainability, security reviewed).

### PO Validation
- PASS â€“ Reviewed by Product Owner; workflow, documentation, and QA artefacts align with Epic 1 goals. No follow-up actions beyond monitoring override log and adding doc lint when feasible.

### Gate Status
- PASS â€“ docs/qa/gates/1.4-bypass-incomplete-status-for-1-3.yml (residual risks low; sustain monitoring of override log).

## ðŸ”¬ Research & Validation Log
- 2025-09-25: Reviewed BMAD story creation workflow, guardrails, and architecture logging/testing standards to scope override requirements.
